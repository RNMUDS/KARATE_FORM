# KARATE FORM VR

Meta Quest 3用のWebXRハンドトラッキングアプリケーションです。

## 概要

このプロジェクトは、VRヘッドセット（特にMeta Quest 3）でハンドトラッキングを使用したインタラクティブな体験を提供します。GLTFフォーマットの3Dモデルを表示し、手や頭の動きで操作することができます。

## 必要な環境

- Node.js (v14以上推奨)
- Meta Quest 3 または WebXR対応のVRヘッドセット
- 同一ネットワーク上のPC（開発用）

## セットアップ

### 1. 依存関係のインストール

```bash
npm install
```

### 2. SSL証明書の生成

WebXR APIはHTTPS接続が必須のため、自己署名証明書を生成する必要があります。

```bash
npm run generate-cert
```

このコマンドで`certs/`ディレクトリに以下のファイルが生成されます：
- `server.cert` - SSL証明書
- `server.key` - 秘密鍵

### 3. サーバーの起動

```bash
node server.js
```

サーバーは `https://0.0.0.0:3000` で起動します。

## アクセス方法

### PCからのアクセス
ブラウザで `https://localhost:3000` にアクセスします。

### Meta Quest 3からのアクセス
1. PCとQuest 3が同じネットワークに接続されていることを確認
2. PCのIPアドレスを確認（Windows: `ipconfig`、Mac/Linux: `ifconfig`）
3. Quest 3のブラウザで `https://[PCのIPアドレス]:3000` にアクセス
4. 証明書の警告が表示されたら「詳細設定」→「安全でないサイトへ移動」を選択

## ファイル構成

### メインアプリケーション

#### `/public/index.html`
- **メインVRアプリケーション**
- VRモードとハンドトラッキング機能
- GLTFモデルの表示とインタラクション
- キーボード操作：
  - `f`キー: front.gltfを前方にスポーン
  - `s`キー: side.gltfを横にスポーン

### 3Dモデル作成・表示ツール

#### `/public/make_gltf.html`
- **GLTFモデル作成ツール**
- 画像から3Dモデル（板状）を生成
- 使い方：
  1. 人型などの画像をアップロード
  2. 切り抜き感度を調整して画像を処理
  3. ブラシツールで細かい編集
  4. 板の厚み、幅、高さ、色を調整
  5. GLTFまたはGLBファイルとしてダウンロード

#### `/public/show_gltf.html`
- **GLTFモデルビューアー**
- 作成したGLTFファイルの表示確認用
- マウスドラッグで回転、ホイールでズーム
- VRモードでの表示も可能

#### `/public/ball.html`
- ハンドトラッキングの別バージョン
- シンプルなボール表示の実装例

### サーバー関連

#### `server.js`
- Express.jsを使用したHTTPSサーバー
- 静的ファイルの配信
- Three.jsライブラリへのアクセス提供

#### `generate-cert.js`
- SSL証明書生成スクリプト
- 開発環境用の自己署名証明書を作成

### ドキュメント

#### `CLAUDE.md`
- Claude Code（AI開発アシスタント）用の設定ファイル
- プロジェクトの概要とアーキテクチャの説明

#### `META_QUEST_SETUP.md`
- Meta Quest 3の詳細なセットアップ手順（日本語）
- ハンドトラッキングの有効化方法
- トラブルシューティング

## GLTFモデルの作成と使用

### 1. モデルの作成
1. `https://localhost:3000/make_gltf.html` にアクセス
2. 画像をアップロードして切り抜き
3. パラメータを調整（板の厚み、サイズ、色など）
4. GLTFファイルをダウンロード

### 2. モデルの確認
1. ダウンロードしたGLTFファイルを `public/` ディレクトリに配置
2. `https://localhost:3000/show_gltf.html` でファイルを選択して表示確認

### 3. メインアプリでの使用
1. `front.gltf` または `side.gltf` という名前で `public/` に配置
2. メインアプリ（index.html）でキーボード操作でスポーン可能

## 開発のヒント

- GLTFファイルは軽量な3Dフォーマットで、WebXRアプリケーションに最適です
- make_gltf.htmlで作成したモデルは、色や材質の情報も含まれます
- 複数のGLTFファイルを切り替えて使用する場合は、index.html内のファイル名を変更してください

## トラブルシューティング

### 証明書エラーが表示される
- 自己署名証明書のため警告が表示されますが、開発環境では問題ありません
- Questのブラウザで「詳細設定」から進んでください

### ハンドトラッキングが動作しない
- Quest 3の設定でハンドトラッキングが有効になっているか確認
- `設定` → `デバイス` → `手と体` → `ハンドトラッキング` をオン

### GLTFモデルが表示されない
- ブラウザの開発者コンソールでエラーを確認
- ファイル名とパスが正しいか確認
- show_gltf.htmlで単体表示できるか確認

## ライセンス

MIT License